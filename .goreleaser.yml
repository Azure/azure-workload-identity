# refer to https://goreleaser.com for more options
version: 2
before:
  hooks:
    - go mod tidy
    - go mod vendor
builds:
  - id: azwi
    dir: cmd/azwi
    binary: azwi
    env:
      - CGO_ENABLED=0
    goos:
      - darwin
      - linux
      - windows
    goarch:
      - amd64
      - arm64
    ignore:
      - goos: windows
        goarch: arm64
    flags:
      - -mod=vendor
    ldflags:
      - -s
      - -w
      - -X {{.ModulePath}}/pkg/version.BuildTime={{.Date}}
      - -X {{.ModulePath}}/pkg/version.BuildVersion={{.Tag}}
      - -X {{.ModulePath}}/pkg/version.Vcs={{.ShortCommit}}
release:
  prerelease: auto
  header: |
    ## {{.Tag}} - {{ time "2006-01-02" }}
  extra_files:
    - glob: deploy/*.yaml
archives:
  - format_overrides:
      - goos: windows
        format: zip
    name_template: "azwi-{{.Tag}}-{{.Os}}-{{.Arch}}"
checksum:
  name_template: 'sha256sums.txt'
  algorithm: sha256
changelog:
  disable: false
  groups:
    - title: Bug Fixes ğŸ
      regexp: ^.*fix[(\\w)]*:+.*$
    - title: Build ğŸ­
      regexp: ^.*build[(\\w)]*:+.*$
    - title: Code Refactoring ğŸ’
      regexp: ^.*refactor[(\\w)]*:+.*$
    - title: Code Style ğŸ¶
      regexp: ^.*style[(\\w)]*:+.*$
    - title: Continuous Integration ğŸ’œ
      regexp: ^.*ci[(\\w)]*:+.*$
    - title: Documentation ğŸ“˜
      regexp: ^.*docs[(\\w)]*:+.*$
    - title: Features ğŸŒˆ
      regexp: ^.*feat[(\\w)]*:+.*$
    - title: Maintenance ğŸ”§
      regexp: ^.*chore[(\\w)]*:+.*$
    - title: Performance Improvements ğŸš€
      regexp: ^.*perf[(\\w)]*:+.*$
    - title: Revert Change â—€ï¸
      regexp: ^.*revert[(\\w)]*:+.*$
    - title: Security Fix ğŸ›¡ï¸
      regexp: ^.*security[(\\w)]*:+.*$
    - title: Testing ğŸ’š
      regexp: ^.*test[(\\w)]*:+.*$
